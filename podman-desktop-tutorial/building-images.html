<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exercise: Building Images in Podman Desktop :: Podman Desktop Tutorial</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/podman-desktop-tutorial/podman-desktop-tutorial/building-images.html">
    <link rel="prev" href="podman-basics.html">
    <link rel="next" href="running-containers.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-scholars.github.io/podman-desktop-tutorial">Podman Desktop Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="podman-desktop-tutorial" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Podman Desktop Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro.html">Introduction to Containers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="env-setup.html">Environment Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="podman-basics.html">Podman Desktop Interface &amp; Essentials</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Working with Podman Desktop</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="building-images.html">Exercise: Building Images in Podman Desktop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="running-containers.html">Exercise: Running and Managing Containers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pods.html">Exercise: Working with Pods</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Targeting Kubernetes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kubernetes-overview.html">Kubernetes Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kubernetes.html">Deploying to Kubernetes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">More Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Inner Loop Development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#development-workflows.adoc">Container-Based Development Workflows</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#iteration-speed.adoc">Testing Applications in Podman Desktop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#kind.adoc">Running Kubernetes with Kind</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#minikube.adoc">Local Kubernetes with Minikube</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#openshift-local.adoc">OpenShift Local Development with Podman Desktop</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#docker.adoc">Using Docker with Podman Desktop</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#resources.adoc">Additional Resources &amp; Documentation</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Podman Desktop Tutorial</a></li>
    <li>Working with Podman Desktop</li>
    <li><a href="building-images.html">Exercise: Building Images in Podman Desktop</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/podman-desktop-tutorial/edit/master/documentation/modules/ROOT/pages/building-images.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Exercise: Building Images in Podman Desktop</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Fantastic, let&#8217;s start the Podman Desktop tutorial with the most basic step in the inner loop development process: <strong>building container images</strong>. We&#8217;ll also cover authenticating to registries amd pulling images.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Feel free skip and simply <a href="#pulling.adoc">pull the container images</a> without downloading the application source code.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demo_application"><a class="anchor" href="#_demo_application"></a>Demo Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this exercise, we&#8217;ll be using a basic Python web server application, which uses a Redis cache to store the number of times we&#8217;ve visited the webpage. This is a simple microservice, but it&#8217;s a good example of a multi-container application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-python-app-browser.png" alt="Podman Desktop Python App" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started_with_the_source_code"><a class="anchor" href="#_getting_started_with_the_source_code"></a>Getting Started with the Source Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start off with downloading the source code for the demo application, found <a href="https://github.com/redhat-developer/podman-desktop-demo">here on GitHub</a>. This repository contains a variety of different Podman related demo&#8217;s you can try later, including Minikube, WASM, Compose, and more!</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-demo-repo.png" alt="Podman Desktop Demo Repo" width="600">
</div>
</div>
<div class="paragraph">
<p>I&#8217;ve cloned the repository to my local machine using <a href="https://desktop.github.com/">GitHub Desktop</a>, but today let&#8217;s use the command line to clone the repository. Open up the terminal, and use the noNVC menu to copy these next two commands to your clipboard, and paste/execute them.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone <a href="https://github.com/redhat-developer/podman-desktop-demo" class="bare">https://github.com/redhat-developer/podman-desktop-demo</a></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-demo-cloned.png" alt="Podman Desktop Demo Cloned" width="600">
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s open up the project in our IDE and take a look at the source code of the demo application, found in the <code>podman-desktop-demo/primary-podify-demo/front</code> directory.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd podman-desktop-demo/primary-podify-demo/front &amp;&amp; code .</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-demo-source-code.png" alt="Podman Desktop Demo Source Code" width="600">
</div>
</div>
<div class="paragraph">
<p>We&#8217;re using Flask as a Python framework to serve the web application, as you can see from the <code>app.py</code> file. However, more important is the <code>Dockerfile</code> in the project directory, which is used to build the container image for the web application, like a recipe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base Image:</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>FROM registry.access.redhat.com/ubi9/ubi:9.2-755 AS ubi-builder</code> (Starts with Red Hat&#8217;s UBI image)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Build Stage:</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>RUN &#8230;&#8203;</code> (Installs tools like Python)</p>
</li>
<li>
<p><code>COPY ./entrypoint.sh &#8230;&#8203;</code> (Copies entrypoint script for when the container starts, for Redis)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>App Preparation:</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>FROM scratch as python-builder</code> (Starts fresh, minimal image)</p>
</li>
<li>
<p><code>COPY --from=ubi-builder &#8230;&#8203;</code> (Copies only built essentials)</p>
</li>
<li>
<p><code>RUN &#8230;&#8203;</code> (Creates non-root user)</p>
</li>
<li>
<p><code>COPY requirements.txt &#8230;&#8203;</code> (Copies Python dependencies)</p>
</li>
<li>
<p><code>RUN pip install &#8230;&#8203;</code> (Installs dependencies)</p>
</li>
<li>
<p><code>COPY app.py &#8230;&#8203;</code> (Copies app source code)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Final Image:</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>FROM scratch</code> (Starts with minimal scratch image)</p>
</li>
<li>
<p><code>COPY --from=python-builder &#8230;&#8203;</code> (Copies prepared application)</p>
</li>
<li>
<p><code>EXPOSE 5000</code> (Opens port for access)</p>
</li>
<li>
<p><code>USER 1000</code> (Switches to non-root user)</p>
</li>
<li>
<p><code>ENV &#8230;&#8203;</code> (Sets Flask environment variables)</p>
</li>
<li>
<p><code>ENTRYPOINT ["/entrypoint.sh"]</code> (Defines container startup command)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While this isn&#8217;t a basic Dockerfile, it&#8217;s a good example of a multi-stage build with security best practices, and allows for a smaller final image.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_the_container_image"><a class="anchor" href="#_building_the_container_image"></a>Building the Container Image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we&#8217;ve taken a look at the source code and Dockerfile, let&#8217;s build the container image from directly within Podman Desktop. From the <strong>Images</strong> section, click the <strong>Build</strong> button in the top right corner.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-build-image-button.png" alt="Podman Desktop Build Image" width="600">
</div>
</div>
<div class="paragraph">
<p>This will open up a new window where we can specify the Dockerfile/Containerfile, the build context, and image name. Let&#8217;s select the <code>Dockerfile</code>, the build directory as <code>primary-podify-demo/front</code>, and <code>python-app</code> for the image name.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The build context is the directory where the source code and Dockerfile are located, and the Dockerfile is the recipe for building the container image. We can use Podman Desktop to easily rename/retag the image later, so don&#8217;t worry too much about the image name for now.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-build-image-window.png" alt="Podman Desktop Build Image Window" width="600">
</div>
</div>
<div class="paragraph">
<p>After clicking <strong>Build</strong>, Podman Desktop will start building the container image, and you can see the build logs in the bottom pane. This will take a few minutes, as it&#8217;s downloading the base image, installing dependencies, copying the source code, etc.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-build-image-logs.png" alt="Podman Desktop Build Image Logs" width="600">
</div>
</div>
<div class="paragraph">
<p>Once the build is complete, you should see the new <code>python-app</code> image in the <strong>Images</strong> section of Podman Desktop. You&#8217;ll see the default image <a href="https://www.redhat.com/sysadmin/container-image-short-names">short name</a> here, which we&#8217;ll retag for our registry in the next section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-built-image.png" alt="Podman Desktop Built Image" width="600">
</div>
</div>
<div class="sect2">
<h3 id="pulling"><a class="anchor" href="#pulling"></a>Optional: Pulling the Python App Image</h3>
<div class="paragraph">
<p>If you&#8217;d like to skip the build process from above, you can pull the <code>quay.io/podman-desktop-demo/podify-demo-frontend:v1</code> image from a public registry. This is the same image we just built, but it&#8217;s already available for use. Head to the <strong>Images</strong> section, and click the <strong>Pull</strong> button in the top right corner.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quay.io/podman-desktop-demo/podify-demo-frontend:v1</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-built-image-layers.png" alt="Podman Desktop Built Image" width="600">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Due to it&#8217;s popularity, Podman uses the Docker Hub registry to pull images by default. However, you can authenticate other registries in the Podman Desktop <strong>Settings &gt; Registries</strong>, or set defaults via the <a href="https://www.redhat.com/sysadmin/manage-container-registries">Podman registry configuration file</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pulling_the_redis_image"><a class="anchor" href="#_pulling_the_redis_image"></a>Pulling the Redis Image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you may have seen from the Python web application source code, we&#8217;re using a Redis cache to store the number of times we&#8217;ve visited the webpage. Thus, if you were to start the Python web application without the Redis cache, it would crash.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-redis-image-start.png" alt="Podman Desktop Redis Image" width="600">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s go ahead and pull a pre-build Redis image from Quay.io by clicking the <strong>Pull</strong> button from the top right corner menu. We&#8217;ll be pulling an image of redis that has been build with the Red Hat UBI, with redis installed on top, which is a popular choice for caching in containerized applications.</p>
</div>
<div class="listingblock console-input][ console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quay.io/podman-desktop-demo/podify-demo-backend:v1</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/podman-desktop-redis-image-layers.png" alt="Podman Desktop Redis Image" width="600">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Containerfile used to build the Redis image is available in the <code>podman-desktop-demo/primary-podify-demo/back</code> directory, but can also be found here. <a href="https://github.com/redhat-developer/podman-desktop-demo/blob/main/primary-podify-demo/backend/Dockerfile" target="_blank" rel="noopener">here</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fantastic! We&#8217;ve built the container image for the Python web application, and pulled the Redis image for the cache. In the next tutorial, we&#8217;ll start the containers and test the web application.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="podman-basics.html">Podman Desktop Interface &amp; Essentials</a></span>
  <span class="next"><a href="running-containers.html">Exercise: Running and Managing Containers</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
